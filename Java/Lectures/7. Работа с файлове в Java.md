# Работа с файлове в Java

## Въведение в I/O

* **I/O (Input/Output):** операции за четене/писане към външен ресурс (файл, конзола, мрежа).
* **Файлов достъп:** чрез път (напр. `C:/Folder/file.txt`).
* **Риск от грешки:** липса на файл, липса на права → използва се **Exception Handling**.

```java
try {
    // рисков код
} catch (Exception e) {
    // обработка
}
```

---

## Създаване на файл (`File`)

```java
File file = new File("C:/newfile.txt");
boolean created = file.createNewFile();
```

* Връща `true`, ако файлът е създаден.
* Хвърля `IOException` при проблем.

---

## Потокова работа (Streams)

* **Byte Streams:** `FileInputStream`, `FileOutputStream` – работят с байтове.
* **Character Streams:** `FileReader`, `FileWriter` – работят със символи (Unicode).

### Копиране на файл (байтово)

```java
FileInputStream in = null;
FileOutputStream out = null;
try {
    in = new FileInputStream("in.txt");
    out = new FileOutputStream("out.txt");
    int c;
    while ((c = in.read()) != -1) {
        out.write(c);
    }
} finally {
    if (in != null) in.close();
    if (out != null) out.close();
}
```

---

## Пример – четене/запис на масив от байтове

```java
byte[] data = {1,2,3,4,5};
OutputStream os = new FileOutputStream("test.txt");
for(byte b : data) os.write(b);
os.close();
```

```java
InputStream is = new FileInputStream("test.txt");
int size = is.available();
for(int i = 0; i < size; i++)
    System.out.print((char) is.read());
is.close();
```

---

## Буферирани потоци (Buffered Streams)

* **Причина:** директният достъп до диск е бавен.
* **Решение:** четене/писане на големи блокове в RAM буфер.

### BufferedReader – четене ред по ред

```java
BufferedReader br = new BufferedReader(new FileReader("file.txt"));
String line;
while ((line = br.readLine()) != null) {
    System.out.println(line);
}
br.close();
```

### BufferedWriter – писане

```java
BufferedWriter bw = new BufferedWriter(new FileWriter("out.txt"));
bw.write("Some text");
bw.newLine();
bw.flush();
bw.close();
```

---

## `try-with-resources` (Java 7+)

Автоматично затваря потоци.

```java
try (BufferedReader br = new BufferedReader(new FileReader("file.txt"))) {
    System.out.println(br.readLine());
}
```

* Не е нужен `finally`.
* Работи с всички класове, които имплементират `AutoCloseable`.

---

## Полезни изключения при файлове

| Изключение              | Причина              |
| ----------------------- | -------------------- |
| `IOException`           | обща I/O грешка      |
| `FileNotFoundException` | файлът не съществува |
| `SecurityException`     | липса на права       |
| `NoSuchFileException`   | пътят е невалиден    |

---
